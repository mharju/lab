shadow$provide[55]=function(mc,Nb,Tb,Hb){(function(m,ka){"function"===typeof define&&define.amd?define([],ka):"object"===typeof Tb&&Tb.exports?Tb.exports=ka():m.parinfer=ka()})(this,function(){function m(f){return"number"===typeof f&&isFinite(f)&&Math.floor(f)===f}function ka(f){f=f||{};return{cursorX:f.cursorX,cursorLine:f.cursorLine,prevCursorX:f.prevCursorX,prevCursorLine:f.prevCursorLine,selectionStartLine:f.selectionStartLine,changes:f.changes,partialResult:f.partialResult,forceBalance:f.forceBalance,
returnParens:f.returnParens}}function Fa(){return{lineNo:-999,startX:-999,endX:-999,openers:[],clamped:{startX:-999,endX:-999,openers:[]}}}function u(f,k){var p={lineNo:f.lineNo,x:f.x,inputLineNo:f.inputLineNo,inputX:f.inputX};return f.errorPosCache[k]=p}function B(f,k){var p=f.errorPosCache[k],v=f.partialResult?"lineNo":"inputLineNo",y=f.partialResult?"x":"inputX",x={parinferError:!0,name:k,message:d[k],lineNo:p?p[v]:f[v],x:p?p[y]:f[y]},J=Ca(f.parenStack,0);if("unmatched-close-paren"===k){if((p=
f.errorPosCache["unmatched-open-paren"])||J)x.extra={name:"unmatched-open-paren",lineNo:p?p[v]:J[v],x:p?p[y]:J[y]}}else"unclosed-paren"===k&&(x.lineNo=J[v],x.x=J[y]);return x}function ha(f,k,p,v,y){var x=f.lines[k];x=x.substring(0,p)+y+x.substring(v);f.lines[k]=x;y=y.length-(v-p);0!==y&&f.cursorLine===k&&-999!==f.cursorX&&(f.cursorX===p&&f.cursorX===v?0===f.cursorX:f.cursorX>=v)&&(f.cursorX+=y)}function na(f){f.x=0;f.lineNo++;f.indentX=-999;f.commentX=-999;f.indentDelta=0;delete f.errorPosCache["unmatched-close-paren"];
delete f.errorPosCache["unmatched-open-paren"];delete f.errorPosCache["leading-close-paren"];f.trackingArgTabStop=null;f.trackingIndent=!f.isInStr}function Ca(f,k){var p=f.length-1;return k>p?null:f[p-k]}function La(f){return"}"===f||")"===f||"]"===f}function ea(f,k){return 0===f.length?!1:Ca(f,0).ch===c[k]}function Q(f){var k=f.ch;return!f.isEscaped&&(" "===k||"  "===k)}function ba(f,k,p,v){return k===v&&-999!==p&&-999!==f&&f>p}function W(f,k,p){return ba(k,p,f.commentX,f.lineNo)}function aa(f,k,
p){f.parenTrail.lineNo=k;f.parenTrail.startX=p;f.parenTrail.endX=p;f.parenTrail.openers=[];f.parenTrail.clamped.startX=-999;f.parenTrail.clamped.endX=-999;f.parenTrail.clamped.openers=[]}function H(f,k){var p;for(p=0;p<f.parenStack.length;p++){var v=Ca(f.parenStack,p),y=v.x<k,x=v.x-v.indentDelta<k-f.indentDelta,J=!1;x&&y?J=!0:x||y?x&&!y?J=0===f.indentDelta?!0:!1:!x&&y&&((y=Ca(f.parenStack,p+1))&&y.indentDelta<=v.indentDelta?J=k+y.indentDelta>v.x?!0:!1:y&&y.indentDelta>v.indentDelta?J=!0:f.indentDelta>
v.indentDelta&&(J=!0),J&&(v.indentDelta=0)):J=!1;if(J)break}return p}function R(f,k){if(k){var p=Ca(f.parenStack,0);p?p.maxChildIndent=k.x:f.maxIndent=k.x}}function ja(f){var k=f.parenTrail,p=k.clamped.openers.concat(k.openers);if(0<p.length&&(k={lineNo:k.lineNo,startX:-999!==k.clamped.startX?k.clamped.startX:k.startX,endX:0===k.openers.length?k.clamped.endX:k.endX},f.parenTrails.push(k),f.returnParens))for(f=0;f<p.length;f++)p[f].closer.trail=k}function N(f,k){var p=f.x,v=p+k,y,x="";for(y=0;y<v;y++)x+=
" ";ha(f,f.lineNo,0,p,x);f.x=v;f.indentX=v;f.indentDelta+=k}function O(f){f.indentX=f.x;f.trackingIndent=!1;if(f.quoteDanger)throw B(f,"quote-danger");if("INDENT_MODE"===f.mode){var k="",p=H(f,f.x),v;for(v=0;v<p;v++){var y=f.parenStack.pop();f.parenTrail.openers.push(y);var x=c[y.ch];k+=x;if(f.returnParens){var J=f.parenTrail.startX+v;y.closer.lineNo=f.parenTrail.lineNo;y.closer.x=J;y.closer.ch=x}}-999!==f.parenTrail.lineNo&&(ha(f,f.parenTrail.lineNo,f.parenTrail.startX,f.parenTrail.endX,k),f.parenTrail.endX=
f.parenTrail.startX+k.length,ja(f));(k=Ca(f.parenStack,0))&&k.indentDelta!==f.indentDelta&&N(f,k.indentDelta)}else if("PAREN_MODE"===f.mode){x=k=f.x;p=0;v=f.maxIndent;if(y=Ca(f.parenStack,0))p=y.x+1,v=y.maxChildIndent,y.indentDelta!==f.indentDelta&&(x+=y.indentDelta);-999!==p&&(x=Math.max(p,x));-999!==v&&(x=Math.min(v,x));x!==k&&N(f,x-k)}}function Y(f,k){f={ch:k.ch,x:k.x,lineNo:k.lineNo};null!=k.argX&&(f.argX=k.argX);return f}function E(f,k){f.ch=k;f.skipChar=!1;if(f.changes&&(f.smart||"PAREN_MODE"===
f.mode)){var p=f.changes[f.inputLineNo];p&&(p=p[f.inputX])&&(f.indentDelta+=p.newEndX-p.oldEndX)}if(f.trackingIndent)if(La(f.ch)){if("INDENT_MODE"===f.mode){if(!f.forceBalance){if(f.smart)throw{leadingCloseParen:!0};f.errorPosCache["leading-close-paren"]||u(f,"leading-close-paren")}f.skipChar=!0}if("PAREN_MODE"===f.mode)if(ea(f.parenStack,f.ch)){p=f.cursorX;var v=f.x;if(f.cursorLine===f.lineNo&&-999!==v&&-999!==p&&p<=v)aa(f,f.lineNo,f.x),O(f);else{p=f;v=p.parenStack.pop();var y=c[v.ch];if(p.returnParens){var x=
p.parenTrail.endX;v.closer.lineNo=p.parenTrail.lineNo;v.closer.x=x;v.closer.ch=y}R(p,v);x=p.parenTrail.endX;ha(p,p.parenTrail.lineNo,x,x,y);p.parenTrail.endX++;p.parenTrail.openers.push(v);(v=p.parenTrails[p.parenTrails.length-1])&&v.lineNo===p.parenTrail.lineNo?(v.endX=p.parenTrail.endX,p.returnParens&&(p.parenTrail.openers[p.parenTrail.openers.length-1].closer.trail=v)):ja(p);f.skipChar=!0}}else if(f.smart)f.skipChar=!0;else throw B(f,"unmatched-close-paren");}else if(";"===f.ch){p=f.parenTrail.openers.length;
if("PAREN_MODE"===f.mode)for(v=0;v<p;v++)f.parenStack.push(Ca(f.parenTrail.openers,v));v=H(f,f.x);(v=Ca(f.parenStack,v))&&v.indentDelta!==f.indentDelta&&N(f,v.indentDelta);if("PAREN_MODE"===f.mode)for(v=0;v<p;v++)f.parenStack.pop();f.trackingIndent=!1}else"\n"!==f.ch&&" "!==f.ch&&"\t"!==f.ch&&O(f);if(f.skipChar)f.ch="";else{p=f.ch;f.isEscaped=!1;if(f.isEscaping){if(f.isEscaping=!1,f.isEscaped=!0,"\n"===f.ch){if(f.isInCode)throw B(f,"eol-backslash");p=f;p.isInComment=!1;p.ch=""}}else if("{"===p||"("===
p||"["===p)f.isInCode&&(p={inputLineNo:f.inputLineNo,inputX:f.inputX,lineNo:f.lineNo,x:f.x,ch:f.ch,indentDelta:f.indentDelta,maxChildIndent:-999},f.returnParens&&(p.children=[],p.closer={lineNo:-999,x:-999,ch:""},v=(v=Ca(f.parenStack,0))?v.children:f.parens,v.push(p)),f.parenStack.push(p),f.trackingArgTabStop="space");else if(La(p)){if(f.isInCode)if(ea(f.parenStack,f.ch)){p=f;v=Ca(p.parenStack,0);p.returnParens&&(y=p.x,x=p.ch,v.closer.lineNo=p.lineNo,v.closer.x=y,v.closer.ch=x);p.parenTrail.endX=
p.x+1;p.parenTrail.openers.push(v);if(v="INDENT_MODE"===p.mode&&p.smart){v=Ca(p.parenStack,0);y=(y=Ca(p.parenStack,1))?y.x+1:0;x=v.x;var J=p.cursorLine===v.lineNo&&y<=p.cursorX&&p.cursorX<=x;if(!p.changes&&-999!==p.prevCursorLine&&p.prevCursorLine===v.lineNo&&y<=p.prevCursorX&&p.prevCursorX<=x&&!J)throw{releaseCursorHold:!0};v=J}v&&(v=p.parenTrail.startX,y=p.parenTrail.endX,x=p.parenTrail.openers,aa(p,p.lineNo,p.x+1),p.parenTrail.clamped.startX=v,p.parenTrail.clamped.endX=y,p.parenTrail.clamped.openers=
x);p.parenStack.pop();p.trackingArgTabStop=null}else{p=f;if("PAREN_MODE"===p.mode){if(v=p.parenTrail,v=v.lineNo===p.lineNo&&v.startX===p.indentX,!p.smart||!v)throw B(p,"unmatched-close-paren");}else"INDENT_MODE"===p.mode&&!p.errorPosCache["unmatched-close-paren"]&&(u(p,"unmatched-close-paren"),v=Ca(p.parenStack,0))&&(y=u(p,"unmatched-open-paren"),y.inputLineNo=v.inputLineNo,y.inputX=v.inputX);p.ch=""}}else'"'===p?f.isInStr?f.isInStr=!1:f.isInComment?(f.quoteDanger=!f.quoteDanger,f.quoteDanger&&u(f,
"quote-danger")):(f.isInStr=!0,u(f,"unclosed-quote")):";"===p?f.isInCode&&(f.isInComment=!0,f.commentX=f.x,f.trackingArgTabStop=null):"\\"===p?f.isEscaping=!0:"\t"===p?f.isInCode&&(f.ch="  "):"\n"===p&&(p=f,p.isInComment=!1,p.ch="");p=f.ch;f.isInCode=!f.isInComment&&!f.isInStr;v=f.ch;y=La(v)&&!f.isEscaped;f.isInCode&&!Q(f)&&""!==v&&!y&&aa(f,f.lineNo,f.x+p.length);if(p=f.trackingArgTabStop)"space"===p?f.isInCode&&Q(f)&&(f.trackingArgTabStop="arg"):"arg"!==p||Q(f)||(Ca(f.parenStack,0).argX=f.x,f.trackingArgTabStop=
null)}p=f.ch;k!==p&&(ha(f,f.lineNo,f.x,f.x+k.length,p),f.indentDelta-=k.length-p.length);f.x+=p.length}function X(f,k,p,v){p={mode:p,smart:v,origText:f,origCursorX:-999,origCursorLine:-999,inputLines:f.split(ya),inputLineNo:-1,inputX:-1,lines:[],lineNo:-1,ch:"",x:0,indentX:-999,parenStack:[],tabStops:[],parenTrail:Fa(),parenTrails:[],returnParens:!1,parens:[],cursorX:-999,cursorLine:-999,prevCursorX:-999,prevCursorLine:-999,selectionStartLine:-999,changes:null,isInCode:!0,isEscaping:!1,isEscaped:!1,
isInStr:!1,isInComment:!1,commentX:-999,quoteDanger:!1,trackingIndent:!1,skipChar:!1,success:!1,partialResult:!1,forceBalance:!1,maxIndent:-999,indentDelta:0,trackingArgTabStop:null,error:{name:null,message:null,lineNo:null,x:null,extra:{name:null,lineNo:null,x:null}},errorPosCache:{}};if(k){m(k.cursorX)&&(p.cursorX=k.cursorX,p.origCursorX=k.cursorX);m(k.cursorLine)&&(p.cursorLine=k.cursorLine,p.origCursorLine=k.cursorLine);m(k.prevCursorX)&&(p.prevCursorX=k.prevCursorX);m(k.prevCursorLine)&&(p.prevCursorLine=
k.prevCursorLine);m(k.selectionStartLine)&&(p.selectionStartLine=k.selectionStartLine);if(Array.isArray(k.changes)){var y=k.changes;if(0===y.length)y=null;else{var x={},J,da;for(da=0;da<y.length;da++){if(J=y[da]){var wa=J.newText.split(ya);var ca=J.oldText.split(ya);var fa=(1===wa.length?J.x:0)+wa[wa.length-1].length;wa=J.lineNo+(wa.length-1);ca={x:J.x,lineNo:J.lineNo,oldText:J.oldText,newText:J.newText,oldEndX:(1===ca.length?J.x:0)+ca[ca.length-1].length,newEndX:fa,newEndLineNo:wa,lookupLineNo:wa,
lookupX:fa}}else ca=void 0;(J=x[ca.lookupLineNo])||(J=x[ca.lookupLineNo]={});J[ca.lookupX]=ca}y=x}p.changes=y}"boolean"===typeof k.partialResult&&(p.partialResult=k.partialResult);"boolean"===typeof k.forceBalance&&(p.forceBalance=k.forceBalance);"boolean"===typeof k.returnParens&&(p.returnParens=k.returnParens)}try{var Ha;for(Ha=0;Ha<p.inputLines.length;Ha++){p.inputLineNo=Ha;y=void 0;x=p;da=Ha;na(x);x.lines.push(x.inputLines[da]);J=void 0;ca=x;if((-999!==ca.selectionStartLine?ca.selectionStartLine:
ca.cursorLine)===ca.lineNo){for(J=0;J<ca.parenStack.length;J++)ca.tabStops.push(Y(ca,ca.parenStack[J]));if("PAREN_MODE"===ca.mode)for(J=ca.parenTrail.openers.length-1;0<=J;J--)ca.tabStops.push(Y(ca,ca.parenTrail.openers[J]));for(J=1;J<ca.tabStops.length;J++){var Oa=ca.tabStops[J].x,Wa=ca.tabStops[J-1].argX;null!=Wa&&Wa>=Oa&&delete ca.tabStops[J-1].argX}}for(y=0;y<x.inputLines[da].length;y++)x.inputX=y,E(x,x.inputLines[da][y]);E(x,"\n");if(!x.forceBalance){var tb=x.errorPosCache["unmatched-close-paren"];
if(tb&&tb.x<x.parenTrail.startX)throw B(x,"unmatched-close-paren");if(x.errorPosCache["leading-close-paren"]&&x.parenTrail.lineNo===x.lineNo)throw B(x,"leading-close-paren");}if(x.lineNo===x.parenTrail.lineNo)if(y=x,y.isInStr)y.parenTrail=Fa();else if("INDENT_MODE"===y.mode){x=void 0;da=y;var gb=da.parenTrail.startX,qb=da.parenTrail.endX,nb;J=da;var Ma=da.cursorX,fb=da.cursorLine;if(nb=ba(Ma,fb,J.parenTrail.startX,J.lineNo)&&!W(J,Ma,fb)){var oa=Math.max(gb,da.cursorX),la=Math.max(qb,da.cursorX),ua=
da.lines[da.lineNo];J=0;for(x=gb;x<oa;x++)La(ua[x])&&J++;var G=da.parenTrail.openers;da.parenTrail.openers=G.slice(J);da.parenTrail.startX=oa;da.parenTrail.endX=la;da.parenTrail.clamped.openers=G.slice(0,J);da.parenTrail.clamped.startX=gb;da.parenTrail.clamped.endX=qb}if(y.parenTrail.startX!==y.parenTrail.endX)for(var qa=y.parenTrail.openers;0!==qa.length;)y.parenStack.push(qa.pop())}else if("PAREN_MODE"===y.mode){R(y,Ca(y.parenTrail.openers,0));if(y.lineNo!==y.cursorLine){x=void 0;da=y;var Aa=da.parenTrail.startX,
Na=da.parenTrail.endX;if(Aa!==Na&&da.lineNo===da.parenTrail.lineNo){var K=da.lines[da.lineNo];J="";ca=0;for(x=Aa;x<Na;x++)La(K[x])?J+=K[x]:ca++;0<ca&&(ha(da,da.lineNo,Aa,Na,J),da.parenTrail.endX-=ca)}}ja(y)}}if(p.quoteDanger)throw B(p,"quote-danger");if(p.isInStr)throw B(p,"unclosed-quote");if(0!==p.parenStack.length&&"PAREN_MODE"===p.mode)throw B(p,"unclosed-paren");"INDENT_MODE"===p.mode&&(na(p),O(p));p.success=!0}catch(D){if(D.leadingCloseParen||D.releaseCursorHold)return X(f,k,"PAREN_MODE",v);
f=D;p.success=!1;if(f.parinferError)delete f.parinferError,p.error=f;else throw p.error.name="unhandled",p.error.message=f.stack,f;}return p}function ra(f){var k=-1!==f.origText.search("\r")?"\r\n":"\n";f.success?(k={text:f.lines.join(k),cursorX:f.cursorX,cursorLine:f.cursorLine,success:!0,tabStops:f.tabStops,parenTrails:f.parenTrails},f.returnParens&&(k.parens=f.parens)):(k={text:f.partialResult?f.lines.join(k):f.origText,cursorX:f.partialResult?f.cursorX:f.origCursorX,cursorLine:f.partialResult?
f.cursorLine:f.origCursorLine,parenTrails:f.partialResult?f.parenTrails:null,success:!1,error:f.error},f.partialResult&&f.returnParens&&(k.parens=f.parens));-999===k.cursorX&&delete k.cursorX;-999===k.cursorLine&&delete k.cursorLine;k.tabStops&&0===k.tabStops.length&&delete k.tabStops;return k}var ya=/\r?\n/,c={"{":"}","}":"{","[":"]","]":"[","(":")",")":"("},d={"quote-danger":"Quotes must balanced inside comment blocks.","eol-backslash":"Line cannot end in a hanging backslash.","unclosed-quote":"String is missing a closing quote.",
"unclosed-paren":"Unclosed open-paren.","unmatched-close-paren":"Unmatched close-paren.","unmatched-open-paren":"Unmatched open-paren.","leading-close-paren":"Line cannot lead with a close-paren.",unhandled:"Unhandled error."};return{version:"3.12.0",indentMode:function(f,k){k=ka(k);return ra(X(f,k,"INDENT_MODE"))},parenMode:function(f,k){k=ka(k);return ra(X(f,k,"PAREN_MODE"))},smartMode:function(f,k){k=ka(k);return ra(X(f,k,"INDENT_MODE",null==k.selectionStartLine))}}})}
goog.provide("module$node_modules$parinfer$parinfer");
goog.global. module$node_modules$parinfer$parinfer=shadow.js.require(55, {});
